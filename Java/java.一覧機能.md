# 一覧表示機能を実装

Javaでデータベースを利用することは少し難しいため、以下の流れで実装を行なっていきます。


① データベースは使用せず、コントローラー内で作成したリストをビューで表示できるようにする


② データベースと連携し、テーブル内のデータをビューで一覧表示できるようにする


FirstAppでは、以下のようにidカラムとmemoカラムのみを扱うシンプルなテーブルを作成します。
>id: 投稿ごとにつけるid

>memo：	投稿されたテキスト


# 一覧表示機能の実装


### 一覧表示用のビューを作成する
##### ビューファイルの編集・作成
[![Image from Gyazo](https://i.gyazo.com/73e8ea956f1580c3f8a9725dedc31cec.png)](https://gyazo.com/73e8ea956f1580c3f8a9725dedc31cec)



##### コントローラーを編集から実装


##### コントローラから見てみましょう。
[![Image from Gyazo](https://i.gyazo.com/233f83721e30c5cba0eab2e24649fc6a.png)](https://gyazo.com/233f83721e30c5cba0eab2e24649fc6a)

一覧表示を行うためのメソッドを、「showList」という名称で追加しています。



また、@GetMappingとアノテーションの記述を行なっていますが、これは@GetMapping("/")と書くのと同じ意味です。

💡**ルートパス（/）を指定する場合の("/")は省略可能です。**

アプリを起動して、ルートパスにアクセスしましょう（localhost:8080）


##### 画像の右と同じ表示になれば成功です。

[![Image from Gyazo](https://i.gyazo.com/40fb9d6227b0032666d2c73ddec6be55.png)](https://gyazo.com/40fb9d6227b0032666d2c73ddec6be55)




### エンティティを作成する
エンティティは、データベースの世界でよく使われる言葉で、簡単に言うと「データの塊」を表すものです。
エンティティはテーブル全体、カラムはテーブルの列とイメージすると分かりやすいです。

>例えば、オンラインストアで管理する「商品」や「顧客」といった一つ一つのものがエンティティに当たります。

エンティティには、テーブルの各カラムに対応した変数を用意します。

今回作成するテーブルには、id、memoというカラムがあるため、エンティティの変数としてid、memoを作成することになります。

>railsには、自動的にエンティティの機能が作成されています。

### ファイルを作成→エンティティの設定までの流れ


①エンティティ用のクラスファイルを作成

作成場所：「firstapp」「src」「main」「java」「in.techcamp.firstapp」


種類：Javaクラス


名称：PostEntity


②作成したPostEntityに、以下の記述を行いましょう。


以下の記述によって、DBのテーブルに含まれる「id」と「memo」カラムに対応するようエンティティを作成しています。


[![Image from Gyazo](https://i.gyazo.com/a92a8ce68daad9fcd8d25080fb16155b.png)](https://gyazo.com/a92a8ce68daad9fcd8d25080fb16155b)


続いて、このクラスにコンストラクタとゲッター・セッターを追加します。

>コンストラクタは、オブジェクトを初期化・生成する役割
>オブジェクトのプロパティ（変数）の値を取得する役割
>セッターは変数に不正な値が代入されるのを防ぎ、変数の値を設定する役割


これらのコードは、IntelliJの機能によって簡単に作成することができます。


この機能を使用すると、現在のカーソル位置にコードが追加されます。

空行を追加して、以下のようにカーソルを移動しましょう。

[![Image from Gyazo](https://i.gyazo.com/01a01cb5e63f034aaf6de211789b8d30.png)](https://gyazo.com/01a01cb5e63f034aaf6de211789b8d30)


続いて「コマンドキー + n」を押しましょう。
自動生成したいコードの種類を選択するダイアログが開きます。


「コンストラクター」が選択されているのを確認して、エンターキーを押しましょう。

idとmemoの両方を選択するので、「シフトキー + 下矢印キー」を押しましょう。

選択できたら、「OK」をクリックします。

[![Image from Gyazo](https://i.gyazo.com/2b8cdbe69eb5186d3232aa3f4f4d194d.gif)](https://gyazo.com/2b8cdbe69eb5186d3232aa3f4f4d194d)


[![Image from Gyazo](https://i.gyazo.com/87392888701649cb27b9a021508a3174.png)](https://gyazo.com/87392888701649cb27b9a021508a3174)

上記のようなコードが自動で表示されます。

次にセッター・ゲッターも同じやり方で設定します。

[![Image from Gyazo](https://i.gyazo.com/fb7b1e68bbfebaef6b741f77223db236.png)](https://gyazo.com/fb7b1e68bbfebaef6b741f77223db236)

ここまでの作業によって、以下のクラスができました。
- 変数として、idおよびmemoを宣言している
- 全ての変数を初期化するコンストラクタがある
- 全ての変数のゲッター・セッターがある


  このクラスをエンティティ（データの単位）として利用します。

  
続いて、このエンティティを使ってデータを作成できるよう、コントローラーにコードを追加していきます。

### コントローラーの設定

コントローラーでデータを作成し、ビューに渡せるようにします。


[![Image from Gyazo](https://i.gyazo.com/b0ae24308dd5dc28ac22cd0a0f9d23b6.png)](https://gyazo.com/b0ae24308dd5dc28ac22cd0a0f9d23b6)
※7行目も追加で記述します

このコードによって、以下の３件のデータを作成しています。

| id  | memo |
| ------------- | ------------- |
| 1  | 投稿1 |
| 2  | 投稿2 |
| 3  | 投稿3 |

List.ofメソッドは、文字通りリストを作成するメソッドです。
PostEntityクラスのオブジェクトを３つ作成して、それらをList.ofメソッドによって１つのリストにまとめています。


そして、作成したpostListをmodelに追加することでビューで使用できるようにしました。


💡同じパッケージの中であれば、インポートせずにPostControllerを使うことができます

### ビューを編集しよう
2・9・10行目を以下のように編集しましょう！

[![Image from Gyazo](https://i.gyazo.com/b216a42624e8da04b817625ca05e82fc.png)](https://gyazo.com/b216a42624e8da04b817625ca05e82fc)

9行目の`<ul th:each="post:${postList}">`の`th:each`は繰り返し処理の機能です。

`${postList}`の中には、コントローラーから渡されたリストの３件分の投稿データが含まれています。

th:eachを使うことで、まずpostListの１件目のデータが変数「post」に格納されます。



その状態で`<li th:text="${post.getMemo()}">`が実行されると実行結果が『投稿1』と表示されて繰り返される状態になります。

ブラウザで確認すると以下の通りです。



[![Image from Gyazo](https://i.gyazo.com/15345f17017fe584954acb750d097947.png)](https://gyazo.com/15345f17017fe584954acb750d097947)



